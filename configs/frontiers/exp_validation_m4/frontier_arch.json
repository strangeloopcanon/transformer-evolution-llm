[
  {
    "id": "xover-5-ae5d",
    "parent": null,
    "metrics": {
      "layers": 6.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.443203303573641,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.2857142857142857,
      "params": 49415249.0,
      "kv_bytes_per_token": 6144,
      "throughput_proxy": 105.96381293402777,
      "ppl_code": 66168.7890625,
      "ppl_train": 68010.3828125,
      "ppl_eval": 66168.7890625,
      "ppl_math": 66168.7890625,
      "throughput": 18.928144824379242,
      "ram": 0.0920430738478899,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 56.33721160888672,
      "instability": 56.33721160888672,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.07056617736816406,
      "passkey_acc": 0.0,
      "passkey_loss": 10.965264797210693,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 66168789.0625,
      "ppl_per_param": 0.001339035832086974,
      "ppl_per_throughput": 3495.7883974596034
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-10-ce2d",
    "parent": null,
    "metrics": {
      "layers": 11.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.4971029536469096,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.3157894736842105,
      "params": 69109329.0,
      "kv_bytes_per_token": 11264,
      "throughput_proxy": 31.526423682851238,
      "ppl_code": 55556.54296875,
      "ppl_train": 34628.7421875,
      "ppl_eval": 55556.54296875,
      "ppl_math": 55556.54296875,
      "throughput": 24.93084170021208,
      "ram": 0.1287261564284563,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 56.5389289855957,
      "instability": 56.5389289855957,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.5970382690429688,
      "passkey_acc": 0.0,
      "passkey_loss": 10.720009803771973,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 55556542.96875,
      "ppl_per_param": 0.0008038935375678442,
      "ppl_per_throughput": 2228.426285674799
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-22-0855",
    "parent": null,
    "metrics": {
      "layers": 4.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.4095560799115194,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.6666666666666666,
      "params": 41537617.0,
      "kv_bytes_per_token": 4096,
      "throughput_proxy": 238.4185791015625,
      "ppl_code": 47184.7265625,
      "ppl_train": 35285.40625,
      "ppl_eval": 47184.7265625,
      "ppl_math": 47184.7265625,
      "throughput": 5.989267435110903,
      "ram": 0.07736984081566334,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 53.802799224853516,
      "instability": 53.802799224853516,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 10.910842895507812,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 47184726.5625,
      "ppl_per_param": 0.0011359516980114675,
      "ppl_per_throughput": 7878.213333051187
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "add_additional_recurrence-24-fe25",
    "parent": "xover-4-c81f",
    "metrics": {
      "layers": 13.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.6519595635504638,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 1.0,
      "novelty": 0.038461538461538464,
      "params": 77249617.0,
      "kv_bytes_per_token": 13312,
      "throughput_proxy": 22.572173169378697,
      "ppl_code": 46413.4765625,
      "ppl_train": 38847.3515625,
      "ppl_eval": 46413.4765625,
      "ppl_math": 46413.4765625,
      "throughput": 69.28669987345909,
      "ram": 0.14388862438499928,
      "long_recall": 0.0,
      "long_recall_proxy": 0.038461538461538464,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 56.33468246459961,
      "instability": 56.33468246459961,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 1.141098976135254,
      "passkey_acc": 0.0,
      "passkey_loss": 10.925605297088623,
      "ppl_code_rec_1": 43572.3671875,
      "ppl_code_rec_2": 19475.435546875,
      "ppl_code_rec_4": 51392.234375,
      "ppl_code_rec_8": 60560.453125,
      "recurrence_gain": -16988.0859375,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 46413476.5625,
      "ppl_per_param": 0.0006008246819204294,
      "ppl_per_throughput": 669.8756997701822
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 5,
            "end": 7,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "zeros",
            "noise_std": 0.02093004954109272,
            "train_recurrence": 1,
            "max_train_recurrence": 6,
            "curriculum_fraction": 0.26658251551029316,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_chunk_memory-27-5366",
    "parent": "xover-21-ea7e",
    "metrics": {
      "layers": 9.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.8018624914211228,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 1.0,
      "novelty": 0.05555555555555555,
      "params": 62544977.0,
      "kv_bytes_per_token": 9216,
      "throughput_proxy": 47.09502797067901,
      "ppl_code": 40077.17578125,
      "ppl_train": 34433.4921875,
      "ppl_eval": 40077.17578125,
      "ppl_math": 40077.17578125,
      "throughput": 4.729554851239968,
      "ram": 0.11649909801781178,
      "long_recall": 0.0,
      "long_recall_proxy": 0.26666666666666666,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 55.25741958618164,
      "instability": 55.25741958618164,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.12344646453857422,
      "passkey_acc": 0.0,
      "passkey_loss": 11.18198013305664,
      "ppl_code_rec_1": 55709.6640625,
      "ppl_code_rec_2": 46956.1953125,
      "ppl_code_rec_4": 47004.71875,
      "ppl_code_rec_8": 47619.015625,
      "ppl_code_rec_16": 77366.96875,
      "recurrence_gain": -21657.3046875,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 40077175.78125,
      "ppl_per_param": 0.0006407736912470205,
      "ppl_per_throughput": 8473.773334237321
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "chunk_memory",
                "chunk_size": 96,
                "stride": 48,
                "heads": 8,
                "head_dim": 64,
                "dropout": 0.0,
                "gating_weight": 0.26625027945785723
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 0,
            "end": 4,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "zeros",
            "noise_std": 0.030669662456581037,
            "train_recurrence": 2,
            "max_train_recurrence": 8,
            "curriculum_fraction": 0.21835833878136715,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_chunk_memory-31-9208",
    "parent": "xover-21-ea7e",
    "metrics": {
      "layers": 9.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.8018624914211228,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 1.0,
      "novelty": 0.05555555555555555,
      "params": 62019921.0,
      "kv_bytes_per_token": 9216,
      "throughput_proxy": 47.09502797067901,
      "ppl_code": 45409.1875,
      "ppl_train": 42703.859375,
      "ppl_eval": 45409.1875,
      "ppl_math": 45409.1875,
      "throughput": 15.428868297602158,
      "ram": 0.11552110500633717,
      "long_recall": 0.0,
      "long_recall_proxy": 0.26666666666666666,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 69.51095581054688,
      "instability": 69.51095581054688,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.22708702087402344,
      "passkey_acc": 0.0,
      "passkey_loss": 11.036022663116455,
      "ppl_code_rec_1": 50371.3125,
      "ppl_code_rec_2": 36996.88671875,
      "ppl_code_rec_4": 56982.39453125,
      "ppl_code_rec_8": 42639.8046875,
      "ppl_code_rec_16": 54239.4140625,
      "recurrence_gain": -3868.1015625,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 45409187.5,
      "ppl_per_param": 0.0007321709987344227,
      "ppl_per_throughput": 2943.131448406826
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "chunk_memory",
                "chunk_size": 64,
                "stride": 32,
                "heads": 4,
                "head_dim": 64,
                "dropout": 0.0,
                "gating_weight": 0.23416254814125848
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 0,
            "end": 4,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "zeros",
            "noise_std": 0.030669662456581037,
            "train_recurrence": 2,
            "max_train_recurrence": 8,
            "curriculum_fraction": 0.21835833878136715,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "insert_retro_module-34-7e9c",
    "parent": "xover-20-8e92",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.6423344025891802,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 0.0,
      "novelty": 0.0625,
      "params": 57095889.0,
      "kv_bytes_per_token": 7424,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 45455.6328125,
      "ppl_train": 30105.517578125,
      "ppl_eval": 45455.6328125,
      "ppl_math": 45455.6328125,
      "throughput": 7.938241544689876,
      "ram": 0.10634938068687916,
      "long_recall": 0.0,
      "long_recall_proxy": 0.225,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 54.950714111328125,
      "instability": 54.950714111328125,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.1716451644897461,
      "passkey_acc": 0.0,
      "passkey_loss": 10.862900733947754,
      "prior_distance": 0.12499999218750048,
      "ppl_per_long_recall": 45455632.8125,
      "ppl_per_param": 0.0007961279456126868,
      "ppl_per_throughput": 5726.158942959681
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 16,
              "head_dim": 32,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 8,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.21605784099110698
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "toggle_linear_attention-38-22f5",
    "parent": "insert_retro_module-34-7e9c",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.81290085419124,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 0.0,
      "novelty": 0.0625,
      "params": 57095889.0,
      "kv_bytes_per_token": 6400,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 45449.828125,
      "ppl_train": 30437.103515625,
      "ppl_eval": 45449.828125,
      "ppl_math": 45449.828125,
      "throughput": 0.0,
      "ram": 0.10634938068687916,
      "long_recall": 0.0,
      "long_recall_proxy": 0.225,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 54.9423942565918,
      "instability": 54.9423942565918,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 10.864265441894531,
      "prior_distance": 0.12499999218750048,
      "ppl_per_long_recall": 45449828.125,
      "ppl_per_param": 0.0007960262800181638,
      "ppl_per_throughput": 45449828125.0
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 16,
              "head_dim": 32,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 8,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "LINEAR",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.21605784099110698
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-40-fa4a",
    "parent": null,
    "metrics": {
      "layers": 7.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.6415269197916824,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 1.0,
      "novelty": 0.2,
      "params": 53616721.0,
      "kv_bytes_per_token": 7168,
      "throughput_proxy": 77.85096460459184,
      "ppl_code": 47161.6953125,
      "ppl_train": 50705.5078125,
      "ppl_eval": 47161.6953125,
      "ppl_math": 47161.6953125,
      "throughput": 24.42345931525966,
      "ram": 0.09986892528831959,
      "long_recall": 0.0,
      "long_recall_proxy": 0.07142857142857142,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 76.89002990722656,
      "instability": 76.89002990722656,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 1.141164779663086,
      "passkey_acc": 0.0,
      "passkey_loss": 10.862595558166504,
      "ppl_code_rec_1": 55299.16796875,
      "ppl_code_rec_2": 24461.00390625,
      "ppl_code_rec_4": 60640.5546875,
      "ppl_code_rec_8": 47527.5078125,
      "ppl_code_rec_16": 66104.390625,
      "recurrence_gain": -10805.22265625,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 47161695.3125,
      "ppl_per_param": 0.0008796079736487429,
      "ppl_per_throughput": 1930.9998106219784
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 0,
            "end": 4,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "zeros",
            "noise_std": 0.030669662456581037,
            "train_recurrence": 2,
            "max_train_recurrence": 8,
            "curriculum_fraction": 0.21835833878136715,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-47-3841",
    "parent": null,
    "metrics": {
      "layers": 6.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.00331962186205,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 2.0,
      "novelty": 0.5,
      "params": 49973889.0,
      "kv_bytes_per_token": 6144,
      "throughput_proxy": 105.96381293402777,
      "ppl_code": 63883.50390625,
      "ppl_train": 60890.609375,
      "ppl_eval": 63883.50390625,
      "ppl_math": 63883.50390625,
      "throughput": 15.988252904011022,
      "ram": 0.09308362193405628,
      "long_recall": 0.0,
      "long_recall_proxy": 0.43333333333333335,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 63.095306396484375,
      "instability": 63.095306396484375,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.022093772888183594,
      "passkey_acc": 0.0,
      "passkey_loss": 10.835197448730469,
      "ppl_code_rec_1": 60258.28515625,
      "ppl_code_rec_2": 44406.84765625,
      "ppl_code_rec_4": 70498.46875,
      "ppl_code_rec_8": 71156.84375,
      "ppl_code_rec_16": 41618.0625,
      "recurrence_gain": 18640.22265625,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 63883503.90625,
      "ppl_per_param": 0.0012783376516134256,
      "ppl_per_throughput": 3995.6525762876413
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "chunk_memory",
                "chunk_size": 128,
                "stride": 64,
                "heads": 1,
                "head_dim": 16,
                "dropout": 0.0,
                "gating_weight": 0.16488729193859447
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 0,
            "end": 4,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "zeros",
            "noise_std": 0.030669662456581037,
            "train_recurrence": 2,
            "max_train_recurrence": 8,
            "curriculum_fraction": 0.21835833878136715,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          },
          {
            "start": 3,
            "end": 7,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "zeros",
            "noise_std": 0.046394167634716446,
            "train_recurrence": 1,
            "max_train_recurrence": 8,
            "curriculum_fraction": 0.16485067330590053,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-49-ddab",
    "parent": null,
    "metrics": {
      "layers": 2.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.3584735175349205,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 1.2,
      "params": 33659985.0,
      "kv_bytes_per_token": 2048,
      "throughput_proxy": 953.67431640625,
      "ppl_code": 49472.1875,
      "ppl_train": 33626.73046875,
      "ppl_eval": 49472.1875,
      "ppl_math": 49472.1875,
      "throughput": 0.0,
      "ram": 0.06269660778343678,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 50.856388092041016,
      "instability": 50.856388092041016,
      "stop_reason_code": 1.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 11.028050422668457,
      "prior_distance": 0.0,
      "ppl_per_long_recall": 49472187.5,
      "ppl_per_param": 0.0014697626127878549,
      "ppl_per_throughput": 49472187500.0
    },
    "spec": {
      "model": {
        "name": "m4-validation-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 50.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 1,
        "passkey_eval_batches": 2,
        "passkey_eval_seq_len": 1024,
        "passkey_eval_min_distance": 512,
        "passkey_eval_lr": null,
        "passkey_eval_batch_size": 2,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 300000000.0,
          "max_kv_bytes_per_token": 32000.0,
          "min_throughput_proxy": 5.0,
          "gate_entropy_min": 0.0,
          "gate_entropy_max": 4.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": null,
        "composite_metrics": [],
        "promotion_prob": 0.25,
        "promotion_min_layers": 10,
        "promotion_min_moe_blocks": 2,
        "promotion_steps_multiplier": 1.5,
        "promotion_tokens_multiplier": 1.5,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 32,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  }
]