[
  {
    "id": "xover-3-e2f3",
    "parent": null,
    "metrics": {
      "layers": 13.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.5125180216296354,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.47619047619047616,
      "params": 75279697.0,
      "kv_bytes_per_token": 6656,
      "throughput_proxy": 22.572173169378697,
      "ppl_code": 137.72496032714844,
      "ppl_train": 16.92400360107422,
      "ppl_eval": 137.72496032714844,
      "ppl_math": 137.72496032714844,
      "throughput": 90.17921658365695,
      "ram": 0.14021936245262623,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 4.441995143890381,
      "instability": 4.441995143890381,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 7.297421455383301,
      "passkey_acc": 0.0,
      "passkey_loss": 6.547972321510315,
      "prior_distance": 0.24999999038461573,
      "ppl_per_long_recall": 137724.96032714844,
      "ppl_per_param": 1.8295100248231398e-06,
      "ppl_per_throughput": 1.5272361586706014
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "duplicate_block_span+tune_router-17-3903",
    "parent": "tune_attn_sparsity+add_recurrence-14-c129",
    "metrics": {
      "layers": 14.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.837847475622315,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 1.0,
      "novelty": 0.15384615384615385,
      "params": 80136785.0,
      "kv_bytes_per_token": 7168,
      "throughput_proxy": 19.46274115114796,
      "ppl_code": 183.5167694091797,
      "ppl_train": 10.999711990356445,
      "ppl_eval": 183.5167694091797,
      "ppl_math": 183.5167694091797,
      "throughput": 22.127749143026662,
      "ram": 0.14926639385521412,
      "long_recall": 0.0,
      "long_recall_proxy": 0.03571428571428571,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 7.869589328765869,
      "instability": 7.869589328765869,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 6.63533353805542,
      "passkey_acc": 0.0,
      "passkey_loss": 6.058057427406311,
      "ppl_code_rec_1": 38.961910247802734,
      "ppl_code_rec_2": 22.96538543701172,
      "ppl_code_rec_4": 43.09415817260742,
      "ppl_code_rec_8": 7.192501544952393,
      "ppl_code_rec_16": 77.7634506225586,
      "recurrence_gain": -38.80154037475586,
      "prior_distance": 0.2974438152607991,
      "ppl_per_long_recall": 183516.7694091797,
      "ppl_per_param": 2.2900440716355127e-06,
      "ppl_per_throughput": 8.293512739275299
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": 192,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "local_global",
              "block_size": null,
              "block_stride": null,
              "global_stride": 64,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": 192,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "local_global",
              "block_size": null,
              "block_stride": null,
              "global_stride": 64,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 5,
            "end": 8,
            "adapter": "gated",
            "adapter_dim": null,
            "concat_prelude": true,
            "init_state": "noise",
            "noise_std": 0.03550536963682541,
            "train_recurrence": 2,
            "max_train_recurrence": 8,
            "curriculum_fraction": 0.1667828257366743,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_attn_sparsity+insert_retro_module-21-6fe8",
    "parent": "tune_router+shuffle_block_span-2-e3e3",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.6423344025891802,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 0.0,
      "novelty": 0.0625,
      "params": 56242257.0,
      "kv_bytes_per_token": 4096,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 123.82315063476562,
      "ppl_train": 283.3907775878906,
      "ppl_eval": 123.82315063476562,
      "ppl_math": 123.82315063476562,
      "throughput": 168.3374759645197,
      "ram": 0.10475936718285084,
      "long_recall": 0.0,
      "long_recall_proxy": 0.225,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 6.889872074127197,
      "instability": 6.889872074127197,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 7.778265476226807,
      "passkey_acc": 0.0,
      "passkey_loss": 7.765098690986633,
      "prior_distance": 0.24999998437500096,
      "ppl_per_long_recall": 123823.15063476562,
      "ppl_per_param": 2.2016035137915186e-06,
      "ppl_per_throughput": 0.7355649710517442
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.7985803135140778
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_memory_tokens+tune_router-31-5e1a",
    "parent": "toggle_mla_attention+duplicate_block_span-28-0732",
    "metrics": {
      "layers": 15.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.156986985484676,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 3.0,
      "recurrences": 1.0,
      "novelty": 0.782608695652174,
      "params": 82873297.0,
      "kv_bytes_per_token": 6528,
      "throughput_proxy": 16.954210069444443,
      "ppl_code": 707.0416259765625,
      "ppl_train": 233.37892150878906,
      "ppl_eval": 707.0416259765625,
      "ppl_math": 707.0416259765625,
      "throughput": 124.22191514237832,
      "ram": 0.15436354465782642,
      "long_recall": 0.0,
      "long_recall_proxy": 0.43333333333333335,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 10.094797134399414,
      "instability": 10.094797134399414,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 7.45158576965332,
      "passkey_acc": 0.0,
      "passkey_loss": 5.5381247997283936,
      "ppl_code_rec_1": 16288.3740234375,
      "ppl_code_rec_2": 334.751953125,
      "ppl_code_rec_4": 69.95731353759766,
      "ppl_code_rec_8": 155.0317840576172,
      "recurrence_gain": 16133.342239379883,
      "prior_distance": 0.24999999166666695,
      "ppl_per_long_recall": 707041.6259765625,
      "ppl_per_param": 8.53159765052623e-06,
      "ppl_per_throughput": 5.691762400911135
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": 4.0,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 32,
                "heads": 1,
                "head_dim": 32,
                "dropout": 0.0,
                "init_std": 0.02,
                "gating_weight": 0.21407105373324276
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 11,
            "end": 13,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "noise",
            "noise_std": 0.017999305634169772,
            "train_recurrence": 3,
            "max_train_recurrence": 2,
            "curriculum_fraction": 0.15735468529303254,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_recurrence+tune_ffn_width_activation-46-5a4f",
    "parent": "xover-32-c411",
    "metrics": {
      "layers": 11.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.9387088141395108,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 1.0,
      "novelty": 0.045454545454545456,
      "params": 67725333.0,
      "kv_bytes_per_token": 5248,
      "throughput_proxy": 31.526423682851238,
      "ppl_code": 136.64065551757812,
      "ppl_train": 100.22977447509766,
      "ppl_eval": 136.64065551757812,
      "ppl_math": 136.64065551757812,
      "throughput": 79.9356728978428,
      "ram": 0.12614826299250126,
      "long_recall": 0.0,
      "long_recall_proxy": 0.23636363636363636,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 7.936673641204834,
      "instability": 7.936673641204834,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 8.939998626708984,
      "passkey_acc": 0.0,
      "passkey_loss": 7.206980109214783,
      "ppl_code_rec_1": 351.314697265625,
      "ppl_code_rec_2": 13.62606143951416,
      "ppl_code_rec_4": 26.252613067626953,
      "ppl_code_rec_8": 15.296534538269043,
      "ppl_code_rec_16": 17.795677185058594,
      "recurrence_gain": 333.5190200805664,
      "prior_distance": 0.2536399032436408,
      "ppl_per_long_recall": 136640.65551757812,
      "ppl_per_param": 2.017570818257595e-06,
      "ppl_per_throughput": 1.709382689405816
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2212,
              "activation": "relu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 7,
            "end": 11,
            "adapter": "gated",
            "adapter_dim": null,
            "concat_prelude": true,
            "init_state": "noise",
            "noise_std": 0.03385272476336291,
            "train_recurrence": 1,
            "max_train_recurrence": 6,
            "curriculum_fraction": 0.3348485741750762,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-141-c741",
    "parent": null,
    "metrics": {
      "layers": 2.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.3584735175349205,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 1.2,
      "params": 33397329.0,
      "kv_bytes_per_token": 1024,
      "throughput_proxy": 953.67431640625,
      "ppl_code": 124.74462890625,
      "ppl_train": 21.51825714111328,
      "ppl_eval": 124.74462890625,
      "ppl_math": 124.74462890625,
      "throughput": 254.6974962027511,
      "ram": 0.06220737285912037,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 4.654149532318115,
      "instability": 4.654149532318115,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 10.014930725097656,
      "passkey_acc": 0.0,
      "passkey_loss": 7.716423869132996,
      "prior_distance": 0.24999993750001562,
      "ppl_per_long_recall": 124744.62890625,
      "ppl_per_param": 3.7351678305247105e-06,
      "ppl_per_throughput": 0.48977563881094244
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_memory_tokens+tune_attn_sparsity-151-47f2",
    "parent": "tune_memory_tokens+tune_router-31-5e1a",
    "metrics": {
      "layers": 15.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.156986985484676,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 3.0,
      "recurrences": 1.0,
      "novelty": 0.782608695652174,
      "params": 82873297.0,
      "kv_bytes_per_token": 6528,
      "throughput_proxy": 16.954210069444443,
      "ppl_code": 843.3740234375,
      "ppl_train": 49.96944808959961,
      "ppl_eval": 843.3740234375,
      "ppl_math": 843.3740234375,
      "throughput": 85.44247107550684,
      "ram": 0.15436354465782642,
      "long_recall": 0.0,
      "long_recall_proxy": 0.43333333333333335,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 6.9998650550842285,
      "instability": 6.9998650550842285,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 5.13975715637207,
      "passkey_acc": 0.0,
      "passkey_loss": 5.412062764167786,
      "ppl_code_rec_1": 134.33340454101562,
      "ppl_code_rec_2": 55.87870407104492,
      "ppl_code_rec_4": 58.2963981628418,
      "ppl_code_rec_8": 102.79151916503906,
      "recurrence_gain": 31.541885375976562,
      "prior_distance": 0.24999999166666695,
      "ppl_per_long_recall": 843374.0234375,
      "ppl_per_param": 1.0176667925224454e-05,
      "ppl_per_throughput": 9.8706651717996
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": 4.0,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 32,
                "heads": 1,
                "head_dim": 32,
                "dropout": 0.0,
                "init_std": 0.02,
                "gating_weight": 0.12403199235251383
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 11,
            "end": 13,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "noise",
            "noise_std": 0.017999305634169772,
            "train_recurrence": 3,
            "max_train_recurrence": 2,
            "curriculum_fraction": 0.15735468529303254,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "toggle_precision+toggle_linear_attention-164-e5bb",
    "parent": "xover-8-850b",
    "metrics": {
      "layers": 16.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.6598641759758843,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.7083333333333334,
      "params": 86702161.0,
      "kv_bytes_per_token": 7680,
      "throughput_proxy": 14.901161193847656,
      "ppl_code": NaN,
      "ppl_train": NaN,
      "ppl_eval": NaN,
      "ppl_math": NaN,
      "throughput": 70.52210154668433,
      "ram": 0.16149535961449146,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": NaN,
      "instability": NaN,
      "stop_reason_code": 3.0,
      "nan_seen": 1.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": NaN,
      "prior_distance": 0.24999999218750027,
      "ppl_per_long_recall": NaN,
      "ppl_per_param": NaN,
      "ppl_per_throughput": NaN
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "LINEAR",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": false,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "shuffle_block_span+insert_custom_module-176-6463",
    "parent": "tune_memory_tokens+tune_router-31-5e1a",
    "metrics": {
      "layers": 15.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.274431536499194,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 3.0,
      "recurrences": 1.0,
      "novelty": 0.8260869565217391,
      "params": 83136209.0,
      "kv_bytes_per_token": 6528,
      "throughput_proxy": 16.954210069444443,
      "ppl_code": 970.2196044921875,
      "ppl_train": 135.71353149414062,
      "ppl_eval": 970.2196044921875,
      "ppl_math": 970.2196044921875,
      "throughput": 133.99091482217375,
      "ram": 0.15485325641930103,
      "long_recall": 0.0,
      "long_recall_proxy": 0.5333333333333334,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 5.692270278930664,
      "instability": 5.692270278930664,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 9.082672119140625,
      "passkey_acc": 0.0,
      "passkey_loss": 5.377707600593567,
      "ppl_code_rec_1": 626.0043334960938,
      "ppl_code_rec_2": 248.6539764404297,
      "ppl_code_rec_4": 156.181640625,
      "ppl_code_rec_8": 306.8288879394531,
      "recurrence_gain": 319.1754455566406,
      "prior_distance": 0.24999999166666695,
      "ppl_per_long_recall": 970219.6044921875,
      "ppl_per_param": 1.1670241115903992e-05,
      "ppl_per_throughput": 7.240935743888427
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "custom",
                "name": "exp-4070",
                "params": {
                  "dim": 256,
                  "activation": "silu",
                  "notes": "auto-generated"
                }
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": 4.0,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 32,
                "heads": 1,
                "head_dim": 32,
                "dropout": 0.0,
                "init_std": 0.02,
                "gating_weight": 0.21407105373324276
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 32,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.15322296660550158
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 11,
            "end": 13,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": false,
            "init_state": "noise",
            "noise_std": 0.017999305634169772,
            "train_recurrence": 3,
            "max_train_recurrence": 2,
            "curriculum_fraction": 0.15735468529303254,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-178-3ce1",
    "parent": null,
    "metrics": {
      "layers": 16.0,
      "moe_blocks": 1.0,
      "graph_entropy": 1.7877947288780376,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.7083333333333334,
      "params": 111908953.0,
      "kv_bytes_per_token": 7680,
      "throughput_proxy": 14.901161193847656,
      "ppl_code": NaN,
      "ppl_train": NaN,
      "ppl_eval": NaN,
      "ppl_math": NaN,
      "throughput": 69.33957692212903,
      "ram": 0.20844666846096516,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": NaN,
      "router_lb": 0.046875,
      "router_load_max": 0.5,
      "router_load_min": 0.0,
      "router_load_cv": 1.851640224456787,
      "capacity_overflow": 0.0,
      "max_grad_norm": NaN,
      "instability": NaN,
      "stop_reason_code": 3.0,
      "nan_seen": 1.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": NaN,
      "prior_distance": 0.2580645078043707,
      "ppl_per_long_recall": NaN,
      "ppl_per_param": NaN,
      "ppl_per_throughput": NaN
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "LINEAR",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "moe",
              "hidden": 2048,
              "n_experts": 8,
              "k": 2,
              "capacity_factor": 1.2,
              "balance": 0.05,
              "shared": 1,
              "router_temperature": null,
              "router_type": "softmax",
              "router_bias_detached": false,
              "shared_expert": false,
              "router_aux_weight": null,
              "router_lb_weight": null,
              "drop_policy": "none",
              "experts": []
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": false,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-183-4cb5",
    "parent": null,
    "metrics": {
      "layers": 21.0,
      "moe_blocks": 1.0,
      "graph_entropy": 1.7853459219757526,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.9310344827586207,
      "params": 130946393.0,
      "kv_bytes_per_token": 10240,
      "throughput_proxy": 8.650107178287982,
      "ppl_code": NaN,
      "ppl_train": NaN,
      "ppl_eval": NaN,
      "ppl_math": NaN,
      "throughput": 61.66816750952102,
      "ram": 0.24390666373074055,
      "long_recall": 0.0,
      "long_recall_proxy": 0.0,
      "router_entropy": NaN,
      "router_lb": 0.046875,
      "router_load_max": 0.5,
      "router_load_min": 0.0,
      "router_load_cv": 1.851640224456787,
      "capacity_overflow": 0.0,
      "max_grad_norm": NaN,
      "instability": NaN,
      "stop_reason_code": 3.0,
      "nan_seen": 1.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": NaN,
      "prior_distance": 0.25609755472932794,
      "ppl_per_long_recall": NaN,
      "ppl_per_param": NaN,
      "ppl_per_throughput": NaN
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "LINEAR",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "moe",
              "hidden": 2048,
              "n_experts": 8,
              "k": 2,
              "capacity_factor": 1.2,
              "balance": 0.05,
              "shared": 1,
              "router_temperature": null,
              "router_type": "softmax",
              "router_bias_detached": false,
              "shared_expert": false,
              "router_aux_weight": null,
              "router_lb_weight": null,
              "drop_policy": "none",
              "experts": []
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": false,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "insert_layer_scale+toggle_precision-188-1977",
    "parent": "xover-50-ac0c",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.967166842244764,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 1.0,
      "recurrences": 1.0,
      "novelty": 0.1875,
      "params": 57311329.0,
      "kv_bytes_per_token": 4096,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 195.90359497070312,
      "ppl_train": 11.307276725769043,
      "ppl_eval": 195.90359497070312,
      "ppl_math": 195.90359497070312,
      "throughput": 101.55553662863124,
      "ram": 0.10675066895782948,
      "long_recall": 0.0,
      "long_recall_proxy": 0.3875,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 7.419004917144775,
      "instability": 7.419004917144775,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 6.840920448303223,
      "passkey_acc": 0.0,
      "passkey_loss": 5.578331470489502,
      "ppl_code_rec_1": 67.42938995361328,
      "ppl_code_rec_2": 13.31179428100586,
      "ppl_code_rec_4": 14.489651679992676,
      "ppl_code_rec_8": 30.284337997436523,
      "ppl_code_rec_16": 260.8902282714844,
      "recurrence_gain": -193.4608383178711,
      "prior_distance": 0.24999998437500096,
      "ppl_per_long_recall": 195903.59497070312,
      "ppl_per_param": 3.418235074791288e-06,
      "ppl_per_throughput": 1.9290291940171052
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 64,
                "heads": 1,
                "head_dim": 16,
                "dropout": 0.0,
                "init_std": 0.02,
                "gating_weight": 0.18599303898688446
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "layer_scale",
                "targets": [
                  "attn"
                ],
                "init": 0.0001,
                "learnable": true
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "recurrences": [
          {
            "start": 6,
            "end": 8,
            "adapter": "gated",
            "adapter_dim": null,
            "concat_prelude": true,
            "init_state": "zeros",
            "noise_std": 0.01893031636553836,
            "train_recurrence": 2,
            "max_train_recurrence": 4,
            "curriculum_fraction": 0.19436722793086464,
            "test_recurrences": [
              1,
              2,
              4,
              8,
              16
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": false,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  }
]