[
  {
    "id": "toggle_selector+add_additional_recurrence+insert_retro_module-35-2aab",
    "parent": "tune_attn_gating+insert_retro_module+toggle_alibi-3-85a1",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.0524516026745654,
      "selector_blocks": 1.0,
      "selector_topk_avg": 64.0,
      "memory_blocks": 2.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 1.0,
      "novelty": 0.125,
      "params": 56800337.0,
      "kv_bytes_per_token": 4096.0,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 166.73146057128906,
      "ppl_train": 88.11614990234375,
      "ppl_eval": 166.73146057128906,
      "ppl_math": 166.73146057128906,
      "throughput": 83.19102104392994,
      "ram": 0.10579887218773365,
      "long_recall": 0.0,
      "long_recall_proxy": 0.5375,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 6.874326229095459,
      "instability": 6.874326229095459,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 8.659765243530273,
      "passkey_acc": 0.0,
      "passkey_loss": 5.640393257141113,
      "ppl_code_rec_1": 28.156213760375977,
      "ppl_code_rec_2": 41.934234619140625,
      "ppl_code_rec_4": 29.975034713745117,
      "ppl_code_rec_8": 44.930084228515625,
      "recurrence_gain": -16.77387046813965,
      "prior_distance": 0.24999998437500096,
      "ppl_per_long_recall": 166731.46057128906,
      "ppl_per_param": 2.9353956222352883e-06,
      "ppl_per_throughput": 2.0042001946729884
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              },
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.8076910644303912
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "dsa",
              "selector_topk": 64,
              "selector_heads": 4,
              "selector_dim": 64,
              "selector_rope": "partial",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": [
          {
            "start": 6,
            "end": 8,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": true,
            "init_state": "noise",
            "noise_std": 0.043899893027359686,
            "train_recurrence": 3,
            "max_train_recurrence": 4,
            "curriculum_fraction": 0.17986275581169536,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "duplicate_block_span+toggle_qk_norm+add_extra_combo-91-10b3",
    "parent": "toggle_mla_attention+insert_custom_module+tune_recurrence-49-b258",
    "metrics": {
      "layers": 10.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.5041019909323046,
      "selector_blocks": 2.0,
      "selector_topk_avg": 64.0,
      "memory_blocks": 4.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 2.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 1.0,
      "recurrences": 1.0,
      "novelty": 0.5833333333333334,
      "params": 65301715.0,
      "kv_bytes_per_token": 4608.0,
      "throughput_proxy": 38.14697265625,
      "ppl_code": 194.03079223632812,
      "ppl_train": 20.63786506652832,
      "ppl_eval": 194.03079223632812,
      "ppl_math": 194.03079223632812,
      "throughput": 53.86975470486011,
      "ram": 0.12163392268121243,
      "long_recall": 0.0,
      "long_recall_proxy": 0.8500000000000001,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 4.006522178649902,
      "instability": 4.006522178649902,
      "stop_reason_code": 3.0,
      "nan_seen": 0.0,
      "loss_spike": 6.419096946716309,
      "passkey_acc": 0.0,
      "passkey_loss": 5.429583191871643,
      "ppl_code_rec_1": 40.702491760253906,
      "ppl_code_rec_2": 59.496185302734375,
      "ppl_code_rec_4": 31.62592315673828,
      "ppl_code_rec_8": 59.584510803222656,
      "recurrence_gain": -18.88201904296875,
      "prior_distance": 0.2499999875000006,
      "ppl_per_long_recall": 194030.79223632812,
      "ppl_per_param": 2.9712970361701546e-06,
      "ppl_per_throughput": 3.601850301702279
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 128,
                "aggregator": "attention",
                "gating_weight": 0.17212707677898365
              },
              {
                "type": "gated",
                "targets": [
                  "attn",
                  "ffn"
                ],
                "init_weight": 0.2879028749497867,
                "learnable": true
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              },
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.8076910644303912
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "custom",
                "name": "exp-8040",
                "params": {
                  "dim": 1024,
                  "activation": "relu",
                  "notes": "auto-generated"
                }
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": 64,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": 2.0,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "dsa",
              "selector_topk": 64,
              "selector_heads": 4,
              "selector_dim": 64,
              "selector_rope": "partial",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": 64,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "dsa",
              "selector_topk": 64,
              "selector_heads": 4,
              "selector_dim": 64,
              "selector_rope": "partial",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": [
          {
            "start": 6,
            "end": 8,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": true,
            "init_state": "noise",
            "noise_std": 0.043899893027359686,
            "train_recurrence": 3,
            "max_train_recurrence": 3,
            "curriculum_fraction": 0.12966136451512297,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-137-6d27",
    "parent": null,
    "metrics": {
      "layers": 14.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.9384252049881052,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 4.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.6590909090909091,
      "params": 79285073.0,
      "kv_bytes_per_token": 7680.0,
      "throughput_proxy": 19.46274115114796,
      "ppl_code": 127.60948181152344,
      "ppl_train": 19.781024932861328,
      "ppl_eval": 127.60948181152344,
      "ppl_math": 127.60948181152344,
      "throughput": 28.832944456072184,
      "ram": 0.14767995662987232,
      "long_recall": 0.0,
      "long_recall_proxy": 0.3857142857142857,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 2.8694612979888916,
      "instability": 2.8694612979888916,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 6.497620582580566,
      "passkey_acc": 0.0,
      "passkey_loss": 7.230166792869568,
      "prior_distance": 0.23214284885204112,
      "ppl_per_long_recall": 127609.48181152344,
      "ppl_per_param": 1.6095019779009782e-06,
      "ppl_per_throughput": 4.425822066349836
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_ffn_width_activation+insert_memory_tokens+tune_attn_sparsity-141-f8b8",
    "parent": "tune_retro+tune_assoc_memory+toggle_branch_router-89-7ccc",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.627211438753311,
      "selector_blocks": 1.0,
      "selector_topk_avg": 64.0,
      "memory_blocks": 4.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 1.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 1.0,
      "novelty": 0.53125,
      "params": 57375589.0,
      "kv_bytes_per_token": 4096.0,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 176.22288513183594,
      "ppl_train": 11.062965393066406,
      "ppl_eval": 176.22288513183594,
      "ppl_math": 176.22288513183594,
      "throughput": 21.37288420259537,
      "ram": 0.10687036253511906,
      "long_recall": 0.0,
      "long_recall_proxy": 1.2125,
      "router_entropy": 1.1375176906585693,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 18.241886138916016,
      "instability": 18.241886138916016,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 6.785727500915527,
      "passkey_acc": 0.0,
      "passkey_loss": 5.4815685749053955,
      "ppl_code_rec_1": 13.595431327819824,
      "ppl_code_rec_2": 17.05583381652832,
      "ppl_code_rec_4": 17.329587936401367,
      "ppl_code_rec_8": 89.49822998046875,
      "recurrence_gain": -75.90279865264893,
      "prior_distance": 0.28206535802063487,
      "ppl_per_long_recall": 176222.88513183594,
      "ppl_per_param": 3.0713913042676727e-06,
      "ppl_per_throughput": 8.245161647880762
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "branch_router",
                "targets": [
                  "ssm",
                  "ffn",
                  "memory",
                  "attn"
                ],
                "router_type": "sequence",
                "hidden": null,
                "dropout": 0.0,
                "temperature": 0.7651843954325362
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 1992,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              },
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.8076910644303912
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 128,
                "aggregator": "gate",
                "gating_weight": 0.4669564918889416
              },
              {
                "type": "assoc_memory",
                "heads": 4,
                "head_dim": 64,
                "feature_map": "elu",
                "dropout": 0.1,
                "gating_weight": 0.36848466258051
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 8,
                "heads": 2,
                "head_dim": 64,
                "dropout": 0.1,
                "init_std": 0.02,
                "gating_weight": 0.10630831761273367
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": 128,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "local_global",
              "block_size": null,
              "block_stride": null,
              "global_stride": 64,
              "dilation": null,
              "selector": "dsa",
              "selector_topk": 64,
              "selector_heads": 4,
              "selector_dim": 64,
              "selector_rope": "partial",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": [
          {
            "start": 6,
            "end": 8,
            "adapter": "linear",
            "adapter_dim": null,
            "concat_prelude": true,
            "init_state": "noise",
            "noise_std": 0.043899893027359686,
            "train_recurrence": 3,
            "max_train_recurrence": 4,
            "curriculum_fraction": 0.17986275581169536,
            "test_recurrences": [
              1,
              2,
              4,
              8
            ]
          }
        ]
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-237-6de0",
    "parent": null,
    "metrics": {
      "layers": 6.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.084541434656015,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 3.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.6428571428571429,
      "params": 48661585.0,
      "kv_bytes_per_token": 3072.0,
      "throughput_proxy": 105.96381293402777,
      "ppl_code": 123.66584014892578,
      "ppl_train": 94.80030059814453,
      "ppl_eval": 123.66584014892578,
      "ppl_math": 123.66584014892578,
      "throughput": 0.43736808789718035,
      "ram": 0.0906392652541399,
      "long_recall": 0.0,
      "long_recall_proxy": 0.7,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 0.21636971831321716,
      "instability": 0.21636971831321716,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 7.3802250623703,
      "prior_distance": 0.24999997916666838,
      "ppl_per_long_recall": 123665.84014892578,
      "ppl_per_param": 2.541344268768183e-06,
      "ppl_per_throughput": 282.75003040001866
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "layer_scale",
                "targets": [
                  "ssm",
                  "memory"
                ],
                "init": 0.0001,
                "learnable": true
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "duplicate_block_span+toggle_kv_policy+add_extra_combo-292-4963",
    "parent": "insert_retro_module+tune_retro+tune_router-178-3eea",
    "metrics": {
      "layers": 5.0,
      "moe_blocks": 1.0,
      "graph_entropy": 2.5827252057519496,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 5.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 1.1153846153846154,
      "params": 83353571.0,
      "kv_bytes_per_token": 1536.0,
      "throughput_proxy": 152.587890625,
      "ppl_code": 121.45014190673828,
      "ppl_train": 25.80099868774414,
      "ppl_eval": 121.45014190673828,
      "ppl_math": 122.66464332580567,
      "throughput": 0.9819216319387076,
      "ram": 0.15525812469422817,
      "long_recall": 0.0,
      "long_recall_proxy": 1.5,
      "router_entropy": 1.6983241438865662,
      "router_lb": 0.003092670114710927,
      "router_load_max": 0.125,
      "router_load_min": 0.0,
      "router_load_cv": 0.6970152647192698,
      "capacity_overflow": 0.0,
      "max_grad_norm": 26.846288681030273,
      "instability": 26.846288681030273,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 7.78849470615387,
      "prior_distance": 0.22222219753086692,
      "ppl_per_long_recall": 121450.14190673828,
      "ppl_per_param": 1.4570478558949596e-06,
      "ppl_per_throughput": 123.68618630689186
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.5558477906108406
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 1024,
                "stride": 64,
                "aggregator": "gate",
                "gating_weight": 0.269205755524364
              },
              {
                "type": "gated",
                "targets": [
                  "attn",
                  "ffn"
                ],
                "init_weight": 0.07864370282020648,
                "learnable": true
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "moe",
              "hidden": 2048,
              "n_experts": 12,
              "k": 8,
              "capacity_factor": 1.2,
              "balance": 0.05,
              "shared": 1,
              "router_temperature": null,
              "router_type": "softmax",
              "router_bias_detached": false,
              "shared_expert": false,
              "router_aux_weight": null,
              "router_lb_weight": null,
              "drop_policy": "none",
              "experts": []
            },
            "ssm": null,
            "extras": [
              {
                "type": "assoc_memory",
                "heads": 4,
                "head_dim": 64,
                "feature_map": "elu",
                "dropout": 0.0,
                "gating_weight": 0.24174725087538818
              },
              {
                "type": "branch_router",
                "targets": [
                  "ffn",
                  "ssm",
                  "attn",
                  "memory"
                ],
                "router_type": "token",
                "hidden": 128,
                "dropout": 0.1,
                "temperature": 1.0197236765316224
              },
              {
                "type": "layer_scale",
                "targets": [
                  "ffn"
                ],
                "init": 0.001,
                "learnable": true
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 64,
                "aggregator": "attention",
                "gating_weight": 0.5558477906108406
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": {
          "cache": "window",
          "window": 1024,
          "quant": "int8",
          "latent_dim": null
        },
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "insert_chunk_memory+tune_memory_tokens+toggle_qk_norm-298-e161",
    "parent": "xover-219-d70b",
    "metrics": {
      "layers": 4.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.0599585034497077,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 3.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 1.0,
      "recurrences": 0.0,
      "novelty": 0.9583333333333334,
      "params": 41685969.0,
      "kv_bytes_per_token": 2048.0,
      "throughput_proxy": 238.4185791015625,
      "ppl_code": 131.2722625732422,
      "ppl_train": 135.66778564453125,
      "ppl_eval": 131.2722625732422,
      "ppl_math": 131.2722625732422,
      "throughput": 4.8427684759985254,
      "ram": 0.07764616794884205,
      "long_recall": 0.0,
      "long_recall_proxy": 1.05,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 8.797658920288086,
      "instability": 8.797658920288086,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 7.053848624229431,
      "prior_distance": 0.24999996875000388,
      "ppl_per_long_recall": 131272.2625732422,
      "ppl_per_param": 3.1490754736501913e-06,
      "ppl_per_throughput": 27.10686319691864
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": 0.5,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "chunk_memory",
                "chunk_size": 96,
                "stride": 96,
                "heads": 4,
                "head_dim": 64,
                "dropout": 0.0,
                "gating_weight": 0.07534525781747477
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 64,
                "heads": 4,
                "head_dim": 32,
                "dropout": 0.0,
                "init_std": 0.02,
                "gating_weight": 0.14468632277750626
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "xover-318-e4fc",
    "parent": null,
    "metrics": {
      "layers": 14.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.059117570273086,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 4.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.5909090909090909,
      "params": 79286609.0,
      "kv_bytes_per_token": 7680.0,
      "throughput_proxy": 19.46274115114796,
      "ppl_code": 122.2382583618164,
      "ppl_train": 57.75531005859375,
      "ppl_eval": 122.2382583618164,
      "ppl_math": 122.2382583618164,
      "throughput": 0.27705513843698276,
      "ram": 0.14768281765282154,
      "long_recall": 0.0,
      "long_recall_proxy": 0.4857142857142857,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 0.12186256051063538,
      "instability": 0.12186256051063538,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 7.730183005332947,
      "prior_distance": 0.23214284885204112,
      "ppl_per_long_recall": 122238.2583618164,
      "ppl_per_param": 1.5417264012617365e-06,
      "ppl_per_throughput": 441.205526998807
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "layer_scale",
                "targets": [
                  "ssm",
                  "attn",
                  "memory"
                ],
                "init": 0.001,
                "learnable": true
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 2,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "tune_attn_shape+tune_experts+mutate_topk-326-6c6c",
    "parent": "xover-228-213a",
    "metrics": {
      "layers": 8.0,
      "moe_blocks": 0.0,
      "graph_entropy": 1.8658226066477308,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 2.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.21875,
      "params": 56669521.0,
      "kv_bytes_per_token": 5632.0,
      "throughput_proxy": 59.604644775390625,
      "ppl_code": 133.744873046875,
      "ppl_train": 8.131495475769043,
      "ppl_eval": 133.744873046875,
      "ppl_math": 133.744873046875,
      "throughput": 3.934181115153852,
      "ram": 0.10555520839989185,
      "long_recall": 0.0,
      "long_recall_proxy": 0.35,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 5.5436553955078125,
      "instability": 5.5436553955078125,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 6.0632442235946655,
      "prior_distance": 0.29687498144531366,
      "ppl_per_long_recall": 133744.873046875,
      "ppl_per_param": 2.3600847631458717e-06,
      "ppl_per_throughput": 33.995606488910894
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 4,
              "head_dim": 128,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 1,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "shift_moe+tune_rope+tune_router_coeffs-333-8a54",
    "parent": "insert_chunk_memory+tune_memory_tokens+toggle_qk_norm-298-e161",
    "metrics": {
      "layers": 4.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.0599585034497077,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 3.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 0.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 1.0,
      "recurrences": 0.0,
      "novelty": 1.0416666666666667,
      "params": 41685969.0,
      "kv_bytes_per_token": 2048.0,
      "throughput_proxy": 238.4185791015625,
      "ppl_code": 131.37351989746094,
      "ppl_train": 28.581893920898438,
      "ppl_eval": 131.37351989746094,
      "ppl_math": 131.37351989746094,
      "throughput": 0.48516078619840647,
      "ram": 0.07764616794884205,
      "long_recall": 0.0,
      "long_recall_proxy": 1.05,
      "router_entropy": 0.0,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 0.1518028974533081,
      "instability": 0.1518028974533081,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 7.048054933547974,
      "prior_distance": 0.2537674083029829,
      "ppl_per_long_recall": 131373.51989746094,
      "ppl_per_param": 3.1515045241592186e-06,
      "ppl_per_throughput": 270.78346732609947
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": 0.5,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "chunk_memory",
                "chunk_size": 96,
                "stride": 96,
                "heads": 4,
                "head_dim": 64,
                "dropout": 0.0,
                "gating_weight": 0.07534525781747477
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "linear",
              "rope_theta": 11205.580807650862,
              "rope_factor": 1.0705931005799765,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "memory_tokens",
                "tokens": 64,
                "heads": 4,
                "head_dim": 32,
                "dropout": 0.0,
                "init_std": 0.02,
                "gating_weight": 0.14468632277750626
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 512,
                "stride": 64,
                "aggregator": "mean",
                "gating_weight": 0.22466430410022487
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  },
  {
    "id": "insert_assoc_memory+tune_retro+tune_branch_router-375-1123",
    "parent": "insert_retro_module+tune_attn_gating+toggle_mla_attention-373-d5e4",
    "metrics": {
      "layers": 13.0,
      "moe_blocks": 0.0,
      "graph_entropy": 2.39271842965168,
      "selector_blocks": 0.0,
      "selector_topk_avg": 0.0,
      "memory_blocks": 4.0,
      "ssm_blocks": 0.0,
      "mla_blocks": 1.0,
      "linear_blocks": 0.0,
      "sparsity_blocks": 0.0,
      "qk_norm_blocks": 0.0,
      "recurrences": 0.0,
      "novelty": 0.5238095238095238,
      "params": 75840533.0,
      "kv_bytes_per_token": 6656.0,
      "throughput_proxy": 22.572173169378697,
      "ppl_code": 123.5825424194336,
      "ppl_train": 96.66080474853516,
      "ppl_eval": 123.5825424194336,
      "ppl_math": 123.5825424194336,
      "throughput": 0.5025047110492583,
      "ram": 0.14126400090754032,
      "long_recall": 0.0,
      "long_recall_proxy": 0.7846153846153847,
      "router_entropy": 1.3706732988357544,
      "router_lb": 0.0,
      "router_load_max": 0.0,
      "router_load_min": 0.0,
      "router_load_cv": 0.0,
      "capacity_overflow": 0.0,
      "max_grad_norm": 5.07627534866333,
      "instability": 5.07627534866333,
      "stop_reason_code": 0.0,
      "nan_seen": 0.0,
      "loss_spike": 0.0,
      "passkey_acc": 0.0,
      "passkey_loss": 7.519023537635803,
      "prior_distance": 0.24999999038461573,
      "ppl_per_long_recall": 123582.5424194336,
      "ppl_per_param": 1.6295051937389944e-06,
      "ppl_per_throughput": 245.9331021223388
    },
    "spec": {
      "model": {
        "name": "m4-longctx-overnight-full-deck-seed",
        "emb": {
          "dim": 512,
          "vocab": 50257,
          "rope": null,
          "dropout": 0.0,
          "init_std": 0.02
        },
        "blocks": [
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "output",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.5557354907295445
              },
              {
                "type": "assoc_memory",
                "heads": 4,
                "head_dim": 64,
                "feature_map": "elu",
                "dropout": 0.0,
                "gating_weight": 0.1411467774946554
              },
              {
                "type": "branch_router",
                "targets": [
                  "attn",
                  "memory",
                  "ffn",
                  "ssm"
                ],
                "router_type": "token",
                "hidden": 64,
                "dropout": 0.0,
                "temperature": 1.3359647451383152
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "MLA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": 128,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 2048,
                "stride": 32,
                "aggregator": "gate",
                "gating_weight": 0.11056761392085611
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": []
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": false,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "layer_scale",
                "targets": [
                  "ssm",
                  "attn",
                  "memory"
                ],
                "init": 0.001,
                "learnable": true
              }
            ]
          },
          {
            "name": null,
            "attn": {
              "kind": "GQA",
              "causal": true,
              "heads": 8,
              "head_dim": 64,
              "rope": "yarn",
              "rope_theta": null,
              "rope_factor": null,
              "alibi": true,
              "linear_feature_map": "elu",
              "kv_latent_dim": null,
              "sw": null,
              "kv_groups": 4,
              "dropout": 0.0,
              "qk_norm_max": null,
              "gating_pos": "none",
              "gating_op": "dense",
              "sparsity": "none",
              "block_size": null,
              "block_stride": null,
              "global_stride": null,
              "dilation": null,
              "selector": "none",
              "selector_topk": null,
              "selector_heads": null,
              "selector_dim": null,
              "selector_rope": "none",
              "selector_detach": false,
              "stencil": null,
              "softmax": null,
              "projection": null,
              "value_glu": null
            },
            "ffn": {
              "type": "dense",
              "hidden": 2048,
              "activation": "swiglu",
              "dropout": 0.0
            },
            "ssm": null,
            "extras": [
              {
                "type": "retro",
                "memory_tokens": 768,
                "stride": 128,
                "aggregator": "attention",
                "gating_weight": 0.4725470456687829
              }
            ]
          }
        ],
        "head": {
          "tie_embeddings": true,
          "vocab": 50257
        },
        "norm": "rmsnorm",
        "kv_policy": null,
        "macro": null,
        "recurrences": []
      },
      "train": {
        "lr": 0.0008,
        "warmup": 500,
        "clip": 1.0,
        "bf16": true,
        "grad_checkpoint": true,
        "max_tokens": 600000,
        "weight_decay": 0.02,
        "seed": 4242,
        "router_lb_coeff": 0.01,
        "router_entropy_coeff": 0.005,
        "entropy_threshold": 0.5,
        "entropy_patience": 3,
        "instability_threshold": 500.0,
        "no_improve_patience": 40,
        "improvement_tolerance": 0.001,
        "ppl_stop_threshold": null,
        "init_checkpoint": null,
        "passkey_eval_steps": 20,
        "passkey_eval_batches": 4,
        "passkey_eval_seq_len": 2048,
        "passkey_eval_min_distance": 1536,
        "passkey_eval_lr": 0.001,
        "passkey_eval_batch_size": 1,
        "passkey_eval_vocab_limit": 256,
        "optimizer": {
          "name": "adamw",
          "lr": null,
          "betas": null,
          "eps": null,
          "weight_decay": null
        }
      },
      "data": {
        "tokenizer": "gpt2",
        "hf_revision": "main",
        "seq_len": 512,
        "batch_size": 1,
        "workers": 0,
        "shards": [
          {
            "name": "ag_news",
            "split": "train",
            "weight": 0.25,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1",
            "weight": 0.35,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "train",
            "weight": 0.4,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_shards": [
          {
            "name": "ag_news",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "wikitext",
            "split": "wikitext-2-raw-v1:test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          },
          {
            "name": "mbpp",
            "split": "test",
            "weight": 1.0,
            "cache_path": null,
            "revision": null
          }
        ],
        "eval_tokens": 16384,
        "healing_shards": [],
        "healing_tokens": null
      },
      "evolution": {
        "rung0_thresholds": {
          "max_params": 250000000.0,
          "max_kv_bytes_per_token": 20000.0,
          "min_throughput_proxy": 2.0
        },
        "rung1_tokens": 200000,
        "rung2_tokens": 600000,
        "population": 24,
        "topk_keep": 0.45,
        "crossover_prob": 0.4,
        "parent_selection": "map_elites",
        "pareto_objectives": [
          "ppl_code",
          "ppl_math",
          "long_recall",
          "throughput",
          "ram"
        ],
        "objectives": {
          "ppl_code": "min",
          "passkey_loss": "min"
        },
        "composite_metrics": [],
        "promotion_prob": 0.0,
        "promotion_min_layers": 0,
        "promotion_min_moe_blocks": 0,
        "promotion_steps_multiplier": 1.0,
        "promotion_tokens_multiplier": 1.0,
        "promotion_min_router_entropy": 0.0,
        "promotion_min_recurrence_gain": 0.0,
        "promotion_max_instability": null,
        "archive_max_elites": 64,
        "adaptive_mutation": true,
        "adaptive_mutation_eta": 0.1,
        "adaptive_mutation_min_weight": 0.05,
        "adaptive_mutation_max_weight": 5.0,
        "weight_inheritance": "parent"
      },
      "priors": {
        "tokens_per_param": 4.0,
        "window_scale": 6.0,
        "rope_theta_default": 10000.0,
        "prior_weight": 0.0,
        "compute_penalty_weight": 0.0
      }
    }
  }
]